<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stok Produk - Rujak Buah Indonesia</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root {
      --primary: #4361ee;
      --secondary: #3f37c9;
      --success: #4cc9f0;
      --danger: #f72585;
      --warning: #f8961e;
      --info: #4895ef;
      --light: #f8f9fa;
      --dark: #212529;
      --white: #ffffff;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f5f7fa;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: var(--white);
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .logo h2 {
      color: var(--primary);
      font-weight: 600;
    }
    
    .datetime {
      font-weight: 500;
      color: var(--info);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .input-group {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .input-field {
      flex: 1;
      min-width: 250px;
      position: relative;
    }
    
    input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.3s ease;
      background-color: var(--light);
    }
    
    input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
      outline: none;
    }
    
    .btn-group {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      border: none;
      font-size: 14px;
    }
    
    .btn i {
      font-size: 16px;
    }
    
    .btn-primary {
      background-color: var(--primary);
      color: white;
    }
    
    .btn-primary:hover {
      background-color: var(--secondary);
      transform: translateY(-2px);
    }
    
    .btn-success {
      background-color: var(--success);
      color: white;
    }
    
    .btn-success:hover {
      background-color: #3aa8d1;
      transform: translateY(-2px);
    }
    
    .btn-danger {
      background-color: var(--danger);
      color: white;
    }
    
    .btn-danger:hover {
      background-color: #e3176b;
      transform: translateY(-2px);
    }
    
    .btn-warning {
      background-color: var(--warning);
      color: white;
    }
    
    .btn-warning:hover {
      background-color: #e0871b;
      transform: translateY(-2px);
    }
    
    .table-container {
      overflow-x: auto;
      margin-top: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: var(--white);
    }
    
    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #e9ecef;
    }
    
    th {
      background-color: var(--primary);
      color: white;
      font-weight: 500;
      text-transform: uppercase;
      font-size: 14px;
    }
    
    tr:hover {
      background-color: #f8f9fa;
    }
    
    .action-btn {
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }
    
    .edit-btn {
      background-color: var(--info);
      color: white;
    }
    
    .delete-btn {
      background-color: var(--danger);
      color: white;
    }
    
    .autocomplete-items {
      position: absolute;
      border: 1px solid #e9ecef;
      background-color: var(--white);
      z-index: 99;
      width: 100%;
      max-height: 200px;
      overflow-y: auto;
      border-radius: 0 0 8px 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .autocomplete-item {
      padding: 10px 15px;
      cursor: pointer;
      border-bottom: 1px solid #e9ecef;
      transition: background-color 0.2s;
    }
    
    .autocomplete-item:hover, .autocomplete-active {
      background-color: #f8f9fa;
    }
    
    .fruit-container {
      margin-top: 30px;
      padding: 20px;
      background-color: var(--white);
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }
    
    .fruit-title {
      color: var(--primary);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .fruit-list {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .fruit-item {
      padding: 8px 15px;
      background-color: #e8f5e9;
      border: 1px solid #a5d6a7;
      border-radius: 20px;
      font-weight: 500;
      color: #2e7d32;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .fruit-item:hover {
      background-color: #c8e6c9;
      transform: translateY(-2px);
    }
    
    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .input-field {
        min-width: 100%;
      }
      
      .btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">
        <i class="fas fa-boxes" style="font-size: 24px; color: var(--primary);"></i>
        <h2>Manajemen Stok Rujak Buah</h2>
      </div>
      <div class="datetime">
        <i class="far fa-calendar-alt"></i>
        <span id="datetime"></span>
      </div>
    </div>
    
    <div class="input-group">
      <div class="input-field autocomplete">
        <input type="text" id="nama" placeholder="Masukkan nama produk" autocomplete="off">
      </div>
      <div class="input-field autocomplete">
        <input type="text" id="jumlah" placeholder="Masukkan jumlah" autocomplete="off">
      </div>
    </div>
    
    <div class="btn-group">
      <button class="btn btn-primary" onclick="tampilkanSisaBuah()">
        <i class="fas fa-eye"></i> Lihat Buah
      </button>
      <button class="btn btn-primary" onclick="tambahProduk()">
        <i class="fas fa-plus"></i> Tambah Produk
      </button>
      <button class="btn btn-warning" onclick="hapusSemua()">
        <i class="fas fa-trash-alt"></i> Hapus Semua
      </button>
      <button class="btn btn-success" onclick="kirimWhatsApp()">
        <i class="fab fa-whatsapp"></i> Kirim WhatsApp
      </button>
    </div>
    
    <div class="table-container">
      <table id="tabel">
        <thead>
          <tr>
            <th width="5%">No</th>
            <th width="35%">Produk</th>
            <th width="25%">Jumlah</th>
            <th width="15%">Edit</th>
            <th width="15%">Hapus</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    
    <div id="buahBelumDitambahkan" class="fruit-container" style="display: none;">
      <h3 class="fruit-title"><i class="fas fa-apple-alt"></i> Buah Belum Ditambahkan</h3>
      <div class="fruit-list"></div>
    </div>
  </div>

  <script>
    const produkOtomatis = [
      "Gula Pedas", "Gula Extra Pedas", "Gula Tidak Pedas", "Kantong Kresek", "Plastik 1/2 Kg", "Kupas Buah", "Isi Staples", "Aida",
      "Kacang", "Garpu", "Box 500 Ml", "Box 750 ml", "Box 1000 ml", "Box 650 Ml", "Cup 100 Ml", "Plastik Putih Gede", "Tisu", "Garam", "Plastik Klip", "Sarung Tangan","MANGGA DR","MANGGAMUDA","PEPAYA","KEDONDONG","JAMBU AIR","JAMBU KRISTAL","BENGKOANG","NANAS","UBI","TIMUN","BELIMBING","APEL"
    ];
    
    const satuanOtomatis = ["KG", "PCs"];
    let produkList = [], editIndex = -1;
    let currentFocusNama = -1, currentFocusJumlah = -1;
    
    document.addEventListener('DOMContentLoaded', function() {
      autocomplete(document.getElementById("nama"), produkOtomatis);
      autocomplete(document.getElementById("jumlah"), satuanOtomatis, true);
      
      document.getElementById("nama").addEventListener("keydown", e => { 
        if (e.key === "Enter") document.getElementById("jumlah").focus(); 
      });
      
      document.getElementById("jumlah").addEventListener("keydown", e => { 
        if (e.key === "Enter") tambahProduk(); 
      });
      
      updateDatetime();
      setInterval(updateDatetime, 1000);
    });
    
    function autocomplete(inp, arr, isJumlah = false) {
      inp.addEventListener("input", function() {
        let val = this.value;
        closeAllLists();
        if (!val) return false;
        
        const listDiv = document.createElement("DIV");
        listDiv.setAttribute("id", this.id + "autocomplete-list");
        listDiv.setAttribute("class", "autocomplete-items");
        this.parentNode.appendChild(listDiv);
        
        const filteredItems = arr.filter(item => 
          item.toLowerCase().includes(val.toLowerCase())
        );
        
        if (filteredItems.length === 0) {
          const itemDiv = document.createElement("DIV");
          itemDiv.innerHTML = "Tidak ditemukan";
          itemDiv.classList.add("autocomplete-item");
          listDiv.appendChild(itemDiv);
          return;
        }
        
        filteredItems.forEach(item => {
          const itemDiv = document.createElement("DIV");
          itemDiv.innerHTML = isJumlah 
            ? highlightMatch(inp.value.replace(/ *\b(KG|PCs)\b/, '').trim(), item) 
            : highlightMatch(val, item);
          itemDiv.classList.add("autocomplete-item");
          itemDiv.addEventListener("click", function() {
            inp.value = isJumlah ? (inp.value.replace(/ *\b(KG|PCs)\b/, '') + " " + item).trim() : item;
            closeAllLists();
          });
          listDiv.appendChild(itemDiv);
        });
      });
      
      inp.addEventListener("keydown", function(e) {
        let list = document.getElementById(this.id + "autocomplete-list");
        if (list) list = list.getElementsByTagName("div");
        let currentFocus = isJumlah ? currentFocusJumlah : currentFocusNama;
        
        if (e.keyCode == 40) currentFocus++;
        else if (e.keyCode == 38) currentFocus--;
        else if (e.keyCode == 13) {
          e.preventDefault();
          if (currentFocus > -1 && list && list[currentFocus]) list[currentFocus].click();
        }
        
        if (isJumlah) currentFocusJumlah = currentFocus;
        else currentFocusNama = currentFocus;
        
        if (list) {
          Array.from(list).forEach((item, i) => {
            item.classList.toggle("autocomplete-active", i === currentFocus);
          });
        }
      });
      
      function closeAllLists(elmnt) {
        const items = document.getElementsByClassName("autocomplete-items");
        for (let item of items) {
          if (elmnt != item && elmnt != inp) item.parentNode.removeChild(item);
        }
      }
      
      document.addEventListener("click", function(e) { 
        closeAllLists(e.target); 
      });
    }
    
    function highlightMatch(text, match) {
      const regex = new RegExp(text, 'gi');
      return match.replace(regex, `<strong>$&</strong>`);
    }
    
    function tambahProduk() {
      const nama = document.getElementById("nama").value.trim();
      const jumlah = document.getElementById("jumlah").value.trim();
      
      if (!nama || !jumlah) {
        showAlert("Harap isi semua kolom", "warning");
        return;
      }
      
      if (editIndex === -1) {
        produkList.push({ nama, jumlah });
        showAlert("Produk berhasil ditambahkan", "success");
      } else {
        produkList[editIndex] = { nama, jumlah };
        editIndex = -1;
        showAlert("Produk berhasil diupdate", "success");
      }
      
      document.getElementById("nama").value = "";
      document.getElementById("jumlah").value = "";
      renderTabel(); 
      tampilkanSisaBuah();
    }
    
    function editProduk(index) {
      const p = produkList[index];
      document.getElementById("nama").value = p.nama;
      document.getElementById("jumlah").value = p.jumlah;
      editIndex = index;
      document.getElementById("nama").focus();
    }
    
    function hapusProduk(index) {
      showConfirm(
        `Hapus Produk "${produkList[index].nama}"?`,
        "Apakah Anda yakin ingin menghapus produk ini?",
        function() {
          produkList.splice(index, 1);
          renderTabel(); 
          tampilkanSisaBuah();
          showAlert("Produk berhasil dihapus", "success");
        }
      );
    }
    
    function hapusSemua() {
      if (produkList.length === 0) {
        showAlert("Tidak ada data untuk dihapus", "info");
        return;
      }
      
      showConfirm(
        "Hapus Semua Data?",
        "Apakah Anda yakin ingin menghapus semua data produk?",
        function() {
          produkList = [];
          renderTabel(); 
          tampilkanSisaBuah();
          showAlert("Semua data berhasil dihapus", "success");
        }
      );
    }
    
    function tampilkanSisaBuah() {
      const sudahAda = produkList.map(p => p.nama.toLowerCase());
      const belumAda = produkOtomatis.filter(buah => !sudahAda.includes(buah.toLowerCase()));
      const container = document.getElementById("buahBelumDitambahkan");
      const fruitList = container.querySelector(".fruit-list");
      
      if (belumAda.length === 0) {
        container.style.display = "none";
        return;
      }
      
      fruitList.innerHTML = "";
      belumAda.forEach(buah => {
        const fruitItem = document.createElement("div");
        fruitItem.className = "fruit-item";
        fruitItem.innerHTML = `<i class="fas fa-apple-alt"></i> ${buah}`;
        fruitItem.onclick = () => tambahDariSisa(buah);
        fruitList.appendChild(fruitItem);
      });
      
      container.style.display = "block";
    }
    
    function tambahDariSisa(namaBuah) {
      produkList.push({ nama: namaBuah, jumlah: "1 KG" });
      renderTabel(); 
      tampilkanSisaBuah();
      showAlert(`Buah ${namaBuah} berhasil ditambahkan`, "success");
    }
    
    function kirimWhatsApp() {
      if (produkList.length === 0) {
        showAlert("Tidak ada data untuk dikirim", "warning");
        return;
      }
      
      const now = new Date();
      const tanggal = now.toLocaleDateString("id-ID", { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
      const jam = now.toLocaleTimeString("id-ID");
      
      let pesan = `📦 *LAPORAN STOK PRODUK*\n\n`;
      pesan += `📅 Tanggal: ${tanggal}\n`;
      pesan += `⏰ Waktu: ${jam}\n\n`;
      pesan += `🛒 *DAFTAR PRODUK:*\n\n`;
      
      produkList.forEach((p, i) => {
        pesan += `${i+1}. ${p.nama.toUpperCase()} - ${p.jumlah}\n`;
      });
      
      pesan += `\nTotal: ${produkList.length} produk\n\n`;
      pesan += `_Laporan dibuat otomatis oleh sistem_`;
      
      const url = `https://wa.me/?text=${encodeURIComponent(pesan)}`;
      window.open(url, "_blank");
    }
    
    function renderTabel() {
      const tbody = document.querySelector("#tabel tbody");
      tbody.innerHTML = "";
      
      if (produkList.length === 0) {
        tbody.innerHTML = `<tr><td colspan="5" class="text-center">Tidak ada data produk</td></tr>`;
        return;
      }
      
      produkList.forEach((p, i) => {
        const row = document.createElement("tr");
        
        const noCell = document.createElement("td");
        noCell.textContent = i + 1;
        row.appendChild(noCell);
        
        const namaCell = document.createElement("td");
        namaCell.textContent = p.nama;
        row.appendChild(namaCell);
        
        const jumlahCell = document.createElement("td");
        jumlahCell.textContent = p.jumlah;
        row.appendChild(jumlahCell);
        
        const editCell = document.createElement("td");
        const editBtn = document.createElement("button");
        editBtn.className = "action-btn edit-btn";
        editBtn.innerHTML = `<i class="fas fa-edit"></i> Edit`;
        editBtn.onclick = () => editProduk(i);
        editCell.appendChild(editBtn);
        row.appendChild(editCell);
        
        const deleteCell = document.createElement("td");
        const deleteBtn = document.createElement("button");
        deleteBtn.className = "action-btn delete-btn";
        deleteBtn.innerHTML = `<i class="fas fa-trash-alt"></i> Hapus`;
        deleteBtn.onclick = () => hapusProduk(i);
        deleteCell.appendChild(deleteBtn);
        row.appendChild(deleteCell);
        
        tbody.appendChild(row);
      });
    }
    
    function updateDatetime() {
      const now = new Date();
      const options = { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      };
      document.getElementById("datetime").textContent = now.toLocaleDateString("id-ID", options);
    }
    
    function showAlert(message, type) {
      // Implementasi alert yang lebih baik bisa menggunakan library atau custom modal
      alert(message);
    }
    
    function showConfirm(title, message, callback) {
      if (confirm(`${title}\n${message}`)) {
        callback();
      }
    }
  </script>
</body>
</html>
